```markdown
# Подсемья и ее сумма

**Ограничение времени**: 2 секунды  
**Ограничение памяти**: 256Mb  
**Ввод**: стандартный ввод или `input.txt`  
**Вывод**: стандартный вывод или `output.txt`  

**В этой задаче запрещено использовать `map`, `set` и аналогичные встроенные структуры.**

> «Нельзя отворачиваться от семьи. Даже если она отвернулась от тебя» (с) *Форсаж 6*

Вы хотите отслеживать суммарное настроение семьи и ее подсемей. Необходимо реализовать две операции:
- `add(i)` — добавить нового члена семьи с настроением `i` (если такой уже есть, ничего не делать)
- `sum(l, r)` — вывести сумму настроений всех членов семьи, чьи настроения находятся в диапазоне `[l, r]`

## Формат ввода
Первая строка содержит число `n` — количество запросов (1 ≤ n ≤ 300000).  
Далее идут `n` строк с операциями:
- `+ i` — `add(i)`
- `? l r` — `sum(l, r)`

**Особенность операций добавления:**
- Если операция `+` идет после запроса `?` с результатом `y`, то выполняется `add((i + y) mod 10⁹)`
- Иначе выполняется обычное `add(i)`

Все числа в диапазоне от 0 до 10⁹.

## Формат вывода
Для каждого запроса `sum` выведите одно число — сумму настроений в указанном диапазоне.

## Пример
**Ввод**  
```
6
+ 1
+ 3
+ 3
? 2 4
+ 1
? 2 4
``

**Вывод**  
```
3
7
```

## Примечание
Для эффективного решения задачи требуется реализовать структуру данных, поддерживающую быструю вставку и запрос суммы по диапазону (например, декартово дерево по неявному ключу или дерево отрезков).