```markdown
# Вторая статистика (RMQ)

**Ограничение времени**: 1 секунда  
**Ограничение памяти**: 64Mb  
**Ввод**: стандартный ввод или `input.txt`  
**Вывод**: стандартный вывод или `output.txt`

## Условие задачи
Необходимо для M заданных диапазонов в массиве длины N находить второй по величине элемент (вторую порядковую статистику). Требуется использовать структуру данных Sparse Table с временем обработки O(1) на запрос и временем подготовки O(N log N).

## Формат ввода
1. N M - размер массива и количество запросов (2 ≤ N ≤ 10⁵, 1 ≤ M ≤ 10⁵)
2. N целых чисел - элементы массива (|aᵢ| ≤ 10⁹)
3. M пар чисел l r - границы диапазонов (1 ≤ l ≤ r ≤ N)

## Формат вывода
Для каждого запроса выведите второй по величине элемент в указанном диапазоне.

## Пример
**Ввод**  
```
10 3
1 2 3 4 5 6 7 8 9 10
1 2
1 10
2 7
``

**Вывод**  
```
2
2
3
```

## Решение
1. **Sparse Table для минимумов**:
   - Строим две Sparse Table:
     - Для хранения минимумов на интервалах
     - Для хранения вторых минимумов

2. **Обработка запроса**:
   - Находим минимальный элемент в диапазоне [l, r]
   - Находим минимальный элемент в поддиапазонах:
     - [l, pos-1]
     - [pos+1, r]
   - Второй минимум - минимум из этих двух значений

3. **Особенности реализации**:
   - Используем бинарные подъемы для быстрого нахождения минимумов
   - Предварительно вычисляем логарифмы для быстрого определения размера блоков

**Сложность**:
- Подготовка: O(N log N)
- Запрос: O(1)

**Примечание**: Гарантируется, что каждый диапазон содержит минимум 2 элемента, поэтому второй минимум всегда существует.